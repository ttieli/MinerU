# MinerU全功能版生产环境配置
# 针对48GB内存系统优化

# =============================================================================
# 端口配置 - 避免与现有服务冲突
# =============================================================================
API_PORT=8008
WEBUI_PORT=3008
MONITOR_PORT=8088
HTTP_PORT=8080
HTTPS_PORT=8443

# =============================================================================
# 版本和构建配置
# =============================================================================
VERSION=2.0-full-prod
BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')
PREDOWNLOAD_MODELS=true

# =============================================================================
# 模型和设备配置
# =============================================================================
MINERU_MODEL_SOURCE=huggingface
DEVICE_MODE=mps
MPS_MEMORY_LIMIT=12G
MPS_MEMORY_FRACTION=0.75

# =============================================================================
# 功能开关 - 全功能启用
# =============================================================================
ENABLE_VLM=true
ENABLE_PIPELINE=true
ENABLE_TABLE=true
ENABLE_FORMULA=true
ENABLE_LLM_AIDED=false
ENABLE_WEBUI=false

# =============================================================================
# 性能配置 - 针对48GB内存优化
# =============================================================================
MAX_WORKERS=6
BATCH_SIZE=3
MEMORY_LIMIT=16G
MEMORY_RESERVATION=8G
CPU_LIMIT=8.0
CPU_RESERVATION=4.0
MODEL_PRECISION=fp16

# 工作进程配置
WORKER_PROCESSES=6
WORKER_THREADS=2
QUEUE_MAX_SIZE=150
REQUEST_TIMEOUT=600

# 并发控制
MAX_CONCURRENT_REQUESTS=6

# =============================================================================
# 内存优化策略
# =============================================================================
MEMORY_EFFICIENT_MODE=true
MODEL_OFFLOAD_CPU=true
CLEAR_CACHE_INTERVAL=100
ADAPTIVE_BATCH_SIZE=true

# =============================================================================
# 日志配置
# =============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=json

# =============================================================================
# LLM配置（可选）
# =============================================================================
LLM_API_KEY=
LLM_BASE_URL=https://api.openai.com/v1
LLM_MODEL=gpt-4

# =============================================================================
# Redis配置
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# =============================================================================
# 监控和健康检查
# =============================================================================
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=15s
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=180s
